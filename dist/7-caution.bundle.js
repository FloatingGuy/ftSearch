(window.webpackJsonp=window.webpackJsonp||[]).push([[221],{1659:function(t,e,i){"use strict";i(871)},2201:function(t,e,i){"use strict";i.r(e);var o=i(24),s=i.n(o),n=i(1),a=i.n(n),r=i(25),c=i(10),u=i(0),l=i(8),p={name:"LocationPop",props:{pop:{type:Object,default:function(){return{}}}},created:function(){var t=this;window.reportVueCreated("src/views/result/block/caution/location-pop.vue"),l.b.onInputChange((function(){t.hide()})),l.b.onInputConfirm((function(){t.hide()})),u.a.$on(u.k.BACK_BUTTON_CLICK,(function(){t.hide()}))},methods:{show:function(){var t;null===(t=this.$refs._rejectiveTip)||void 0===t||t.show()},hide:function(){var t;null===(t=this.$refs._rejectiveTip)||void 0===t||t.hide()},onTapSetting:function(){this.hide(),this.$emit("tap:setting")}}},d=(i(1659),i(4)),f=Object(d.a)(p,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.pop?i("div",[i("ui-half-screen",{ref:"_rejectiveTip",attrs:{"class-name":"rejective-tip","can-scroll":!0,header:{close:!0},footer:{}}},[i("div",{staticClass:"pop-location-auth"},[i("ui-image",{attrs:{url:"https://res.wx.qq.com/a/fed_upload/1ca60e69-bed2-47e6-804d-4cdd6801b5cf/weui-icon-outlined-location.svg",size:40}}),t.pop.title?i("div",{staticClass:"title"},[t._v(t._s(t.pop.overSeaTitle||t.pop.title))]):t._e(),t.pop.desc?i("div",{staticClass:"desc"},[i("span",[t._v(t._s(t.pop.desc))]),t.pop.descAction?i("span",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"desc-action active__link",on:{click:function(e){return e.stopPropagation(),t.onTapSetting.apply(null,arguments)}}},[t._v(t._s(t.pop.descAction.title))]):t._e()]):t._e()],1)])],1):t._e()}),[],!1,null,"b2723cf0",null).exports,v=i(3),h=i(2);function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function _(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach((function(e){a()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var b={sticky:1,sort:2},g=new c.a({first:1,rejective:2,week:3}),y=new c.a({notDetermined:0,authorized:1,systemWithoutPermission:2,sceneWithoutPermission:3,restricted:4}),C="alreadySuggestedAuth",O="locationAuthExpiredTimestamp",j={name:"Caution",components:{locationPop:f},mixins:[u.n,u.l],props:{d:{type:Object,default:function(){return{}}},typePos:{type:Number,default:0}},data:function(){return{Util:u.g,showType:b,AuthStyle:g,outlined:"https://res.wx.qq.com/a/fed_upload/1ca60e69-bed2-47e6-804d-4cdd6801b5cf/weui-icon-outlined-location.svg",filled:"https://res.wx.qq.com/t/fed_upload/3031f870-96ac-4721-ae98-dfbce92c24e1/weui-icon-filled-location.svg",isFirst:!1,isReject:!1,isOverSeaUser:!!u.b.queryString.isOverSeaUser}},computed:_(_({item:function(){var t,e=this,i=null===(t=this.d.items)||void 0===t?void 0:t[0];if(this.isLocationBox){var o,s=null==i||null===(o=i.authStatus)||void 0===o?void 0:o.find((function(t){return t.type===e.computedShowType}));return Object.assign({},i,s,{docID:"".concat(null==i?void 0:i.docID,"-").concat(g[null==s?void 0:s.type])})}return i},pos:function(){return 1}},Object(r.c)({resultObj:function(t){return t.result.self.resultObj}})),{},{hasTopBar:function(){return this.resultObj.filter},forbidRefreshLocation:function(){return this.resultObj.forbidRefreshLocation},isLocationBox:function(){return 53===this.d.subType},authInfo:function(){return u.b.locationAuth},isVisible:function(){var t;return!this.isLocationBox||!u.b.activeCancleAuthTip&&(null===(t=this.authInfo)||void 0===t?void 0:t.isLocationAuthExptEnable)&&this.platformVisible&&!this.forbidRefreshLocation},platformVisible:function(){var t,e,i;return(null===(t=this.authInfo)||void 0===t?void 0:t.status)==y.sceneWithoutPermission||Global.os.ios&&(null===(e=this.authInfo)||void 0===e?void 0:e.status)==y.notDetermined||Global.os.android&&(null===(i=this.authInfo)||void 0===i?void 0:i.status)==y.systemWithoutPermission},computedShowType:function(){if(this.authInfo)return this.isReject?g.rejective:this.isOverSeaUser?g.week:this.isFirst?g.first:g.week},isRejective:function(){return this.item.type===g.rejective}}),created:function(){if(this.isLocationBox&&this.isVisible){u.d.getStore(C)||(this.isFirst=!0,u.d.store(C,1));var t=u.d.getStore(O);t&&Date.now()<t&&(this.isReject=!0)}},methods:{resolveClass:function(t){switch(t){case b.sticky:return"caution__sticky";case b.sort:return"caution__sort";default:return"caution__sticky"}},onTapSetting:function(t){var e,i,o,s=this;if((null===(e=this.authInfo)||void 0===e?void 0:e.status)===y.sceneWithoutPermission)u.i.reqCapabilityAuth({capability:1,authScene:11},(function(e){if(0===(null==e?void 0:e.retCode)){if(e.ignored)return;e.succeed?(u.b.setValue({locationAuth:_(_({},s.authInfo),{},{status:e.status})}),u.d.remove(O),v.a.$emit(v.b.setQuery,{page:h.f.RESULT,searchId:u.b.searchId}),s._report(t,{actionType:h.g.CONFIRM_CHANGE_CODE,clickContent:"允许"})):(s.isReject=!0,u.d.store(O,Date.now()+1728e5),s._report(t,{actionType:h.g.CANCEL_CHANGE_CODE,clickContent:"拒绝"}))}}));else if((null===(i=this.authInfo)||void 0===i?void 0:i.status)===y.notDetermined&&Global.os.ios||(null===(o=this.authInfo)||void 0===o?void 0:o.status)===y.systemWithoutPermission&&Global.os.android){[8,8192].includes(u.b.type)||u.i.reqCapabilityAuth({capability:1,authScene:11},(function(t){if(0===(null==t?void 0:t.retCode)){if(6==t.status)return void u.i.openWeiXinPage({pageUrl:"search://page/jumpSystemSetting"});t.succeed&&(v.a.$emit(v.b.setQuery,{page:h.f.RESULT,searchId:u.b.searchId}),u.i.getCurrentLocation()),u.b.setValue({locationAuth:_(_({},s.authInfo),{},{status:t.status})})}}))}this._report(t,{actionType:h.g.CLICK_SHOW_DIALOG})},onTapClose:function(t){u.b.setValue({activeCancleAuthTip:!0}),this._report(t,{actionType:h.g.CLICK_DELETE})},onTapLocationBox:function(t){if(this.isRejective){if(!this.isRejective||!this.isOverSeaUser)return;this.$refs._jectivePop.show()}else this.onTapSetting();this._report(t,{actionType:h.g.CLICK_SHOW_DIALOG})},_report:function(t,e){var i;if(t){var o=null==t||null===(i=t.currentTarget)||void 0===i?void 0:i.getAttribute("data-report-id"),n=(null==o?void 0:o.split("$$"))||[],a=s()(n,4),r=a[2],c=a[3];this.M_clickReport(Object.assign({reportId:r,itemPos:c,cardExtInfo:{isOverSeaUser:this.isOverSeaUser}},e))}}}},w=(i(3084),Object(d.a)(j,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isVisible?i("div",{staticClass:"caution",class:{"with-top-bar":t.hasTopBar}},[i("div",{directives:[{name:"active",rawName:"v-active.stop",value:!!(t.isLocationBox&&t.item&&(!t.isRejective||t.isRejective&&t.isOverSeaUser)),expression:"!!(isLocationBox && item && (!isRejective || (isRejective && isOverSeaUser)))",modifiers:{stop:!0}}],staticClass:"caution__item expose_log_elem active__item",class:[t.resolveClass(t.item.showType),{"location-auth__box":t.isLocationBox}],attrs:{"data-id":t.M_exposeId(),"data-back-report-id":t.M_docReportId()}},[t.isLocationBox&&t.item?i("div",{class:["location-auth",""+t.AuthStyle[t.item.type]],attrs:{"data-report-id":t.M_itemReportId("panel:panel:"+t.Util.getRandom())},on:{click:function(e){return e.stopPropagation(),t.onTapLocationBox.apply(null,arguments)}}},[i("div",{staticClass:"auth-left"},[i("ui-image",{staticClass:"icon",attrs:{url:t.item.type===t.AuthStyle.first?t.filled:t.outlined}}),i("div",{staticClass:"text"},[t.item.title?i("p",{staticClass:"title"},[t._v(t._s(t.isOverSeaUser&&t.item.overSeaTitle||t.item.title))]):t._e(),t.item.desc?i("p",{staticClass:"desc"},[t._v(t._s(t.item.desc))]):t._e()])],1),i("div",{staticClass:"auth-right"},[t.isRejective?t.isOverSeaUser?i("ui-arrow",{attrs:{direction:"down",align:"flex"}}):t._e():[i("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"button active__mask",attrs:{role:"button","data-report-id":t.M_itemReportId("setting:setting:"+t.Util.getRandom())},on:{click:function(e){return e.stopPropagation(),t.onTapSetting.apply(null,arguments)}}},[t._v("去设置")]),i("ui-icon",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"active__mask expand-hotspot",attrs:{name:"close",role:"button","aria-label":",关闭","data-report-id":t.M_itemReportId("close:close:"+t.Util.getRandom())},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapClose.apply(null,arguments)}}})]],2)]):[i("ui-image",{staticClass:"caution__item-icon",attrs:{url:"https://res.wx.qq.com/a/fed_upload/2ca94ec4-e220-411d-950c-04f3fcb46851/icons_outlined_info.svg"}}),i("div",{staticClass:"caution__item-wording"},[t._v("\n        "+t._s(t.item.title)+"\n      ")])]],2),t.isRejective&&t.isOverSeaUser?i("locationPop",{ref:"_jectivePop",attrs:{pop:Object.assign({},t.item.pop)},on:{"tap:setting":t.onTapSetting}}):t._e()],1):t._e()}),[],!1,null,"a02824f2",null));e.default=w.exports},3084:function(t,e,i){"use strict";i(872)},871:function(t,e,i){},872:function(t,e,i){}}]);