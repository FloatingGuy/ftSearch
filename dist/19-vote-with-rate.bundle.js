(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{1320:function(t,e,n){},1321:function(t,e,n){},1322:function(t,e,n){},1323:function(t,e,n){},1324:function(t,e,n){},1325:function(t,e,n){},1326:function(t,e,n){},1327:function(t,e,n){},1328:function(t,e,n){},1378:function(t,e,n){"use strict";n(1322)},1379:function(t,e,n){"use strict";n(1323)},1380:function(t,e,n){"use strict";n(1325)},2039:function(t,e,n){"use strict";n(1326)},2040:function(t,e,n){"use strict";n(1327)},2176:function(t,e,n){"use strict";n.r(e);var i=n(489),a=n(39),o=n(459),s={created:function(){window.reportVueCreated("src/components/global/look-a-look-tip/index.vue")},name:"LookALookTip",props:{tip:{type:Object,default:function(){return{}}}},methods:{show:function(){this.$refs._lookalookTip.show()},hide:function(){this.$refs._lookalookTip.hide()},onTapButton:function(){this.hide(),this.$emit("confirm")}}},r=(n(804),n(4)),c={created:function(){window.reportVueCreated("src/views/result/block/official-zone/components/common/sync-to-look-a-look-tips.vue")},name:"SyncToLookALookTips",components:{LookALookTip:Object(r.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-half-screen",{ref:"_lookalookTip",attrs:{"class-name":"look-a-look-tip"},scopedSlots:t._u([{key:"footer",fn:function(){return[n("a",{staticClass:"weui-btn weui-btn_default",attrs:{role:"button"},on:{click:function(e){return e.stopPropagation(),t.onTapButton.apply(null,arguments)}}},[t._v("\n      "+t._s(t.tip.button)+"\n    ")])]},proxy:!0}])},[n("div",{staticClass:"header",attrs:{role:"option"}},[n("ui-image",{staticClass:"icon",attrs:{url:"https://res.wx.qq.com/a/fed_upload/2ca94ec4-e220-411d-950c-04f3fcb46851/news.svg"}}),n("h3",[t._v(t._s(t.tip.title)),n("span",{staticClass:"ui-aria-hidden"},[t._v(".")])]),n("p",[t._v(t._s(t.tip.desc))])],1),n("div",{staticClass:"tip-image"})])}),[],!1,null,"4466cbd0",null).exports},props:["info","tip"],methods:{onTapInfo:function(){this.tip&&this.$refs.lookalookTip.show(),this.$emit("tap:info")}}},l=(n(806),Object(r.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"sync-to-look-a-look-tips expand-hotspot__vertical active__mask",attrs:{role:"button"},on:{click:function(e){return e.stopPropagation(),t.onTapInfo.apply(null,arguments)}}},[n("span",[t._v(t._s(t.info.text))]),n("span",{staticClass:"info-icon-wrapper",attrs:{"aria-hidden":"true"}},[t.info.iconUrl&&t.tip?n("ui-image",{staticClass:"info-icon",attrs:{url:t.info.iconUrl}}):t._e()],1),t.tip?n("look-a-look-tip",{ref:"lookalookTip",attrs:{tip:t.tip}}):t._e()],1)}),[],!1,null,"74f71d20",null).exports),u=n(0),f=n(46),d=n.n(f),h={created:function(){window.reportVueCreated("src/basic-components/packages/ui-rate/src/component.vue")},name:"UiRate",model:{prop:"value",event:"change"},props:{total:{type:Number,default:5},value:{type:Number,default:0},disabled:{type:Boolean,default:!1}},data:function(){return{rateValue:this.value}},computed:{styles:function(){for(var t=Math.floor(this.value),e=this.value-t,n=[],i=0,a=this.total;i<a;++i)n.push({width:i<t?"100%":i>t?"0%":"".concat(100*e,"%")});return n}},watch:{value:function(){this.rateValue=this.value}},methods:{onTap:function(t){this.disabled||(this.rateValue=this.rateValue===t?0:t,this.$emit("change",this.rateValue))}}},p=(n(1378),Object(r.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"ui-rate",attrs:{"aria-hidden":t.disabled}},t._l(t.total,(function(e){return n("li",{key:e,staticClass:"ui-rate-star-wrap",attrs:{role:"button",title:e+"星"},on:{click:function(n){return t.onTap(e)}}},[n("ui-icon",{staticClass:"ui-rate-star",attrs:{name:"ui-star-no-padding"}}),n("span",{staticClass:"ui-rate-active-star-wrap",style:t.styles[e-1]},[n("ui-icon",{staticClass:"ui-rate-star active",attrs:{name:"ui-star-no-padding"}})],1)],1)})),0)}),[],!1,null,null,null).exports);p.install=function(t){t.component(p.name,p)};var m=p,v={created:function(){window.reportVueCreated("src/basic-components/packages/ui-rate-half-screen/src/component.vue")},name:"UiRateHalfScreen",components:{UiRate:m},model:{prop:"value",event:"change"},props:{title:{type:String,default:""},desc:{type:String,default:""},value:{type:Number,default:0},canSubmit:{type:Boolean,default:!1}},data:function(){return{slotHeight:"",rateValue:this.value,hasSubmit:!1}},watch:{value:function(){this.rateValue=this.value}},mounted:function(){this.slotHeightCache=0},methods:{show:function(){var t=this;this.$refs.halfScreen.show(),this.slotHeight="",setTimeout((function(){t.slotHeightCache=t.$refs.dialogSlot.clientHeight,t.slotHeight=0}))},hide:function(){this.hasSubmit=!1,this.$refs.halfScreen.hide(),this.onClose()},showSlot:function(){this.slotHeight="".concat(this.slotHeightCache,"px")},hideSlot:function(){this.slotHeight=0},onChange:function(){this.$emit("change",this.rateValue)},onClose:function(){this.$emit("close"),this.slotHeight=""},onTapSubmit:function(){this.canSubmit&&(this.hasSubmit=!0,this.$emit("submit",this.rateValue))}}},_=(n(1379),Object(r.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-half-screen",{ref:"halfScreen",attrs:{header:{close:!0}},on:{"tap:close":t.onClose,"tap:mask":t.onClose}},[n("div",{staticClass:"ui-rate-half-page-dialog"},[n("div",{staticClass:"ui-rate-dialog-head"},[n("div",{staticClass:"ui-rate-dialog-title"},[t._v(t._s(t.title))]),n("p",{staticClass:"ui-rate-dialog-desc",attrs:{role:"option","aria-live":"polite"}},[t._v(t._s(t.desc))])]),n("div",{staticClass:"ui-rate-dialog-body",class:{"ui-rate-dialog-body-with-slot":t.slotHeight}},[n("ui-rate",{on:{change:t.onChange},model:{value:t.rateValue,callback:function(e){t.rateValue=e},expression:"rateValue"}}),n("div",{ref:"dialogSlot",staticClass:"ui-rate-dialog-slot",style:{height:t.slotHeight},attrs:{"aria-hidden":!t.slotHeight}},[t._t("default")],2)],1),n("div",{staticClass:"ui-rate-dialog-foot"},[n("a",{staticClass:"weui-btn weui-btn_primary",class:{"weui-btn_disabled":!t.canSubmit},attrs:{href:"javascript:",role:"button"},on:{click:t.onTapSubmit}},[t._v("提交")])])])])}),[],!1,null,null,null).exports);_.install=function(t){t.component(_.name,_)};var k=_,g={name:"UiAvatar",props:{src:String,size:{type:[String,Number]},round:{type:Boolean,default:!1}},computed:{style:function(){var t=this.size,e=this.round,n={};return t&&("number"==typeof t?(n.width="".concat(t,"px"),n.height="".concat(t,"px"),n.borderRadius="".concat(Math.ceil(t/10),"px")):(n.width=t,n.height=t)),e&&(n.borderRadius="".concat(t/2,"px")),n}}},b=(n(3403),Object(r.a)(g,(function(){var t=this.$createElement;return(this._self._c||t)("div",{directives:[{name:"load-background",rawName:"v-load-background:avatar",value:this.src,expression:"src",arg:"avatar"}],staticClass:"ui-avatar",style:this.style})}),[],!1,null,"11ae6a66",null).exports);b.install=function(t){t.component(b.name,b)};var y=b,S={created:function(){window.reportVueCreated("src/basic-components/packages/ui-avatar-half-screen/src/component.vue")},name:"UiAvatarHalfScreen",components:{UiRate:m,UiAvatar:y},props:{title:{type:String,default:""},total:{type:Number,default:5},data:{type:Array,required:!0}},methods:{show:function(){this.$refs.halfScreen.show()},hide:function(){this.$refs.halfScreen.hide(),this.onClose()},onClose:function(){this.$emit("close")},onTapBottom:function(){this.$emit("tap:bottom")},onTapUser:function(t){this.$emit("tap:user",t)}}},T=(n(1380),Object(r.a)(S,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-half-screen",{ref:"halfScreen",attrs:{header:{close:!0,title:t.title},"can-scroll":"","class-name":"ui-avatar-half-screen"},on:{"tap:close":t.onClose,"tap:mask":t.onClose}},[n("div",{staticClass:"ui-avatar-half-screen__list"},t._l(t.data,(function(e){return n("div",{key:e.rate,staticClass:"ui-avatar-half-screen__item"},[void 0!==e.rate?n("div",{staticClass:"ui-avatar-half-screen__title"},[n("span",[t._v(t._s(e.rate)+"分")]),n("ui-rate",{attrs:{total:t.total,value:e.rate,disabled:""}}),n("span",{staticClass:"ui-avatar-half-screen__title-desc"},[t._v(t._s(e.desc))])],1):t._e(),e.users.length?n("div",{staticClass:"ui-avatar-half-screen__users"},t._l(e.users,(function(e,i){return n("div",{directives:[{name:"active",rawName:"v-active"}],key:i+e.name+e.avatar,staticClass:"ui-avatar-half-screen__user",on:{click:function(n){return t.onTapUser(e)}}},[n("ui-avatar",{attrs:{src:e.avatar,size:48}}),n("div",{staticClass:"ui-avatar-half-screen__user-name"},[t._v("\n            "+t._s(e.name)+"\n          ")])],1)})),0):t._e()])})),0),n("div",{staticClass:"ui-avatar-half-screen__bottom",on:{click:t.onTapBottom}},[t._t("bottom",(function(){return[n("div",{staticClass:"ui-avatar-half-screen__bottom-default",attrs:{role:"button"}},[t._v("参与互动")])]}))],2)])}),[],!1,null,null,null).exports);T.install=function(t){t.component(T.name,T)};var x=T,C=n(32),I=n.n(C),w=n(86),L=n(64),B=n(24),j=n.n(B),O=n(33),H=n.n(O),V=n(23),$=n.n(V),M=n(263),U=n.n(M),N={name:"UiAvatars",components:{UiAvatar:y},props:{size:{type:Number,default:20},list:{type:Array,default:function(){return[]}},wrap:{type:Boolean,default:!0},shrink:{type:Boolean,default:!1},max:{type:Number,default:0},count:{type:Number,default:0},shrinkLimit:{type:Number,default:5}},data:function(){return{}},computed:{_wrap:function(){return!this.shrink&&this.wrap},listToShow:function(){return this.shrink?this.list.slice(0,99).slice(0,-1):this.list},countToShow:function(){return this.count||this.list.length}},watch:{list:{deep:!0,handler:function(){this.renderShrink()}}},updated:function(){var t=this;this.$nextTick((function(){t._renderShrink()}))},created:function(){window.reportVueCreated("src/basic-components/packages/ui-avatars/src/component.vue"),this.renderShrink=this.renderShrink.bind(this)},mounted:function(){this.$nextTick(this.renderShrink),this.onResize=U()(this.renderShrink.bind(this),100),window.addEventListener("resize",this.onResize)},beforeDestroy:function(){window.removeEventListener("resize",this.onResize)},methods:{renderShrink:function(){var t=this;this.$forceUpdate(),this.$nextTick((function(){t._renderShrink()}))},_renderShrink:function(){var t=this;return H()($.a.mark((function e(){var n,i,a,o,s,r,c,l,u,f,d,h,p,m,v,_,k,g,b,y;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.shrink){e.next=2;break}return e.abrupt("return");case 2:if(n=t.$refs,i=n.ctn,a=n.avatars,o=n.count,s=n.last,a&&!(a.length<2)){e.next=5;break}return e.abrupt("return");case 5:for(a.forEach((function(t){t.style.display="",t.style.width=""})),i.style.flexWrap="",o.style.width="",i.style.offset,r=Math.max(a.length,t.max-1),c=a[1].getBoundingClientRect().left-a[0].getBoundingClientRect().left,l=function(){s.classList.add("ui-avatars__last-count"),o.innerHTML="",i.style.width="100%",i.style.offset;var e=i.getBoundingClientRect(),n=s.getBoundingClientRect().width,a=Math.floor(e.width/c);o.innerHTML=t.max||t.countToShow,i.style.offset;var r=s.getBoundingClientRect().width,l=e.width-c*a+n-r;return o.innerHTML=t.countToShow,s.classList.remove("ui-avatars__last-count"),o.style.width="".concat(r,"px"),i.style.width="",i.style.offset,[a,l]}(),u=j()(l,2),f=u[0],d=u[1],h=Math.min(Math.max(r-f,0),t.shrinkLimit),m=(p=f-1+h)+1;m<r;++m)a[m]&&(a[m].style.display="none");if(p+1<a.length&&s.classList.add("ui-avatars__last-count"),!((v=c*h-d)<0)){e.next=20;break}return e.abrupt("return");case 20:k=2*v/(_=2*h+3)/(_+1),g=_;case 23:if(!(g>=1)){e.next=32;break}if(b=a[p+g-_]){e.next=27;break}return e.abrupt("continue",29);case 27:y=b.getBoundingClientRect().width-g*k,b.style.width="".concat(y,"px");case 29:--g,e.next=23;break;case 32:i.style.flexWrap="nowrap";case 33:case"end":return e.stop()}}),e)})))()}}},R=(n(2039),Object(r.a)(N,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui-avatars",class:{"ui-avatars-wrap":t._wrap,"ui-avatars-shrink":t.shrink}},[n("div",{staticClass:"ui-avatars__desc"},[t._t("default")],2),t.list.length?[n("div",{ref:"ctn",staticClass:"ui-avatars__list",style:{height:t._wrap?"":t.size/16+"rem"}},t._l(t.listToShow,(function(t){return n("div",{key:t+Math.random(),ref:"avatars",refInFor:!0,staticClass:"ui-avatars__avatar"},[n("ui-avatar",{attrs:{src:t}})],1)})),0),t.shrink?n("div",{ref:"last",staticClass:"ui-avatars__last"},[n("ui-avatar",{attrs:{src:t.list[t.list.length-1]}}),n("div",{ref:"count",staticClass:"ui-avatars__count"},[t._v(t._s(t.countToShow))])],1):t._e()]:n("div",{staticClass:"ui-avatars__empty"})],2)}),[],!1,null,"7945e14d",null).exports);R.install=function(t){t.component(R.name,R)};var A=R,E={created:function(){window.reportVueCreated("src/basic-components/packages/ui-vote-movie/src/component.vue")},name:"UiVoteMovie",components:{UiIconLoading:w.a,UiSectionTitle:L.a,UiRate:m,UiAvatars:A},props:{likeButton:Object,seenButton:Object,like:Object,seen:Object,vote:Number,comment:Object},data:function(){return{hasInit:!1,idPrefix:"".concat(Math.random())}},computed:{likeBtn:function(){return Object.assign({text:"想看",selected:!1},this.likeButton)},seenBtn:function(){return Object.assign({text:"想看",selected:!1},this.seenButton)},likeObj:function(){return this.like?Object.assign({text:"想看",desc:"",list:[]},this.like):null},seenObj:function(){return this.seen?Object.assign({text:"看过",desc:"",list:[]},this.seen):null},commentObj:function(){return this.comment?Object.assign({text:"想法",desc:"",list:[]},this.comment):null},seenMax:function(){return Math.max.apply(Math,I()(this.seenObj.list.map((function(t){return t.list.length}))))},voteStr:function(){var t="".concat(parseInt(10*this.vote)),e=t.slice(0,-1)||"0",n=t.slice(-1);return"评分".concat(e,".").concat(n)}},watch:{$props:function(){this.hasInit=!1}},mounted:function(){var t=this;setTimeout((function(){return t.hasInit=!0}),50)},methods:{markButtons:function(){var t=this.$refs.buttons;t&&t.classList.add("active"),setTimeout((function(){t&&t.classList.remove("active")}),1500)},onTapLikeBtn:function(){this.$emit("tap:like-btn")},onTapSeenBtn:function(){this.$emit("tap:seen-btn")},onTapLike:function(){this.$emit("tap:like")},getTargetKey:function(t){for(var e=t,n=0;n<100&&e&&e!==document.body;n+=1){var i=e.dataset.key;if(i)return i;e=e.parentElement}},onTapSeen:function(t){var e=this.getTargetKey(t.target);this.$emit("tap:seen",e||"")},onTapComment:function(){this.$emit("tap:comment")}}},P=(n(2040),Object(r.a)(E,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"ui-vote-movie"},[n("div",{ref:"buttons",staticClass:"ui-vote-movie__buttons"},[n("div",{staticClass:"ui-vote-movie__button",class:{selected:t.likeBtn.selected},attrs:{role:"button",tabindex:"-1","aria-live":t.hasInit?"polite":"none","aria-labelledby":t.idPrefix+"-like-text"},on:{click:function(e){return e.stopPropagation(),t.onTapLikeBtn.apply(null,arguments)}}},[t.likeBtn.loading?n("ui-icon-loading",{attrs:{"aria-hidden":"true"}}):t.likeBtn.selected?n("ui-icon",{attrs:{name:"done"}}):t._e(),n("span",{attrs:{id:t.idPrefix+"-like-text"}},[n("span",[t._v(t._s(t.likeBtn.text))]),t.likeBtn.selected?t._e():n("span",{staticClass:"ui-aria-hidden"},[t._v(",未选择")]),t.likeBtn.selected?n("span",{staticClass:"ui-aria-hidden"},[t._v(",已选择")]):t._e()])],1),n("div",{staticClass:"ui-vote-movie__button",class:{selected:t.seenBtn.selected},attrs:{role:"button",tabindex:"-1","aria-labelledby":t.idPrefix+"-seen-text","aria-live":t.hasInit?"polite":"none"},on:{click:function(e){return e.stopPropagation(),t.onTapSeenBtn.apply(null,arguments)}}},[t.seenBtn.loading?n("ui-icon-loading",{attrs:{"aria-hidden":"true"}}):t.seenBtn.selected?n("ui-icon",{attrs:{name:"done"}}):t._e(),n("span",{attrs:{id:t.idPrefix+"-seen-text"}},[t._v("\n        "+t._s(t.seenBtn.text)+"\n        "),t.seenBtn.selected?t._e():n("span",{staticClass:"ui-aria-hidden"},[t._v(",未选择")]),t.seenBtn.selected?n("span",{staticClass:"ui-aria-hidden"},[t._v(",已选择")]):t._e()])],1)]),t._t("button-vote-spacing"),t.likeObj?n("div",{directives:[{name:"active",rawName:"v-active"}],staticClass:"ui-vote-movie__like-area",on:{click:function(e){return e.stopPropagation(),t.onTapLike.apply(null,arguments)}}},[n("ui-section-title",{staticClass:"ui-vote-movie__title",attrs:{role:"option"},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapLike.apply(null,arguments)}}},[n("span",[t._v(t._s(t.likeObj.text))]),n("span",[t._v(t._s(t.likeObj.desc))]),n("ui-arrow",{attrs:{align:"flex"}})],1),n("ui-avatars",{staticClass:"ui-vote-movie__avatars",attrs:{list:t.likeObj.list}})],1):t._e(),t.seenObj?n("div",{directives:[{name:"active",rawName:"v-active"}],staticClass:"ui-vote-movie__seen-area",on:{click:function(e){return e.stopPropagation(),t.onTapSeen.apply(null,arguments)}}},[n("ui-section-title",{staticClass:"ui-vote-movie__title",attrs:{role:"button"},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapSeen.apply(null,arguments)}}},[n("span",[t._v(t._s(t.seenObj.text))]),n("span",{staticClass:"ui-aria-hidden"},[t._v(",")]),n("span",[t._v(t._s(t.seenObj.desc))]),n("span",{staticClass:"ui-aria-hidden"},[t._v(",")]),n("span",{staticClass:"vote"},[t._v(t._s(t.voteStr))]),n("ui-rate",{attrs:{total:5,value:t.vote,disabled:""}}),n("ui-arrow",{attrs:{align:"flex"}}),n("span",{staticClass:"ui-aria-hidden"},[t._v(".查看详情")])],1),t.seenObj.list.length&&t.seenObj.list[0].text?t._l(t.seenObj.list,(function(e){var i=e.list,a=e.text;return n("ui-avatars",{key:a,staticClass:"ui-vote-movie__avatars",attrs:{list:i,shrink:"",max:t.seenMax,"data-key":a,"aria-hidden":"true"}},[t._v(t._s(a))])})):[n("ui-avatars",{staticClass:"ui-vote-movie__avatars",attrs:{list:t.seenObj.list}})]],2):t._e(),t.commentObj?n("div",{directives:[{name:"active",rawName:"v-active"}],staticClass:"ui-vote-movie__comment-area",on:{click:function(e){return e.stopPropagation(),t.onTapComment.apply(null,arguments)}}},[t.commentObj.text?n("ui-section-title",{staticClass:"ui-vote-movie__comment-title ui-vote-movie__title",attrs:{role:"button"},nativeOn:{click:function(e){return e.stopPropagation(),t.onTapComment.apply(null,arguments)}}},[n("span",[t._v(t._s(t.commentObj.text))]),t.commentObj.desc?n("span",[t._v(t._s(t.commentObj.desc))]):t._e(),n("ui-arrow",{attrs:{align:"flex"}}),n("span",{staticClass:"ui-aria-hidden"},[t._v(".查看详情")])],1):t._e(),t._l(t.commentObj.list,(function(e){return n("div",{key:e.title,staticClass:"ui-vote-movie__comment-line",attrs:{role:"option"}},[n("span",{staticClass:"ui-vote-movie__comment-line-title"},[t._v("\n        "+t._s(e.title)),n("span",{staticClass:"ui-aria-hidden"},[t._v(" 说")]),t._v(":\n      ")]),n("span",{staticClass:"ui-vote-movie__comment-line-desc"},[t._v("\n        "+t._s(e.desc)+"\n      ")])])}))],2):t._e()],2)}),[],!1,null,"3b035a41",null).exports);P.install=function(t){t.component(P.name,P)};var z,J=P,D={0:"你对这部电影的评分",1:"不推荐",2:"一般",3:"还不错",4:"推荐",5:"强烈推荐"},Z={components:{hd:i.a,SyncToLookALookTips:l,UiRateHalfScreen:k,UiAvatarHalfScreen:x,UiVoteMovie:J},mixins:[a.a,o.a],props:{data:{type:Object,default:function(){return{}}},item:{type:Object,default:function(){return{}}},pos:{type:Number,default:0},typePos:{type:Number,default:0}},data:function(){return{COMMENT_MAX_LENGTH:200,rateHalfScreenTextareaValue:"",rateHalfScreenRate:0,rateHalfScreenDesc:D[0],rateHalfScreenCanSubmit:!1,voteObject:JSON.parse(JSON.stringify(this.item.vote||{})),commentInfo:JSON.parse(JSON.stringify(this.item.commentInfo||{})),likeText:"想看",likeButtonLoading:!1,seenText:"看过",seenButtonLoading:!1}},computed:{voteInfoList:function(){return this.voteObject.voteInfoList||[]},averageRate:function(){return this.voteObject.scoreVoteInfo.averageScore||0},myVoteId:function(){var t=this.voteInfoList.find((function(t){return t.selectBySelf}));return t?t.voteId:""},myUserInfo:function(){return this.voteObject.selfUserInfo},likeButton:function(){return this.voteObject.scoreVoteInfo&&this.voteObject.scoreVoteInfo.likeButton||{}},likeUserList:function(){var t=this.likeButton.voteIdList[0],e=this.findVoteInfoByVoteId(t);return e&&e.userInfo?e.userInfo.map((function(t){return t.headImgUrl})):[]},likeAvatarHalfScreenData:function(){var t=this,e=this.likeButton.voteIdList[0],n=this.findVoteInfoByVoteId(e);return n&&n.userInfo?[{users:n.userInfo.map((function(e){return{avatar:e.headImgUrl,name:e.nickname,openId:e.openId,type:t.likeText}}))}]:[]},seenButton:function(){return this.voteObject.scoreVoteInfo&&this.voteObject.scoreVoteInfo.seenButton||{}},seenUserListSingle:function(){var t=this,e=[];return this.seenButton.voteIdList.forEach((function(n){var i=t.findVoteInfoByVoteId(n);i&&i.userInfo&&i.userInfo.length&&(e=i.userInfo.map((function(t){return t.headImgUrl})))})),e},seenUserList:function(){var t=this,e=[];return this.seenButton.voteIdList.forEach((function(n){var i=t.findVoteInfoByVoteId(n);i&&e.unshift({text:i.voteName,list:i.userInfo&&i.userInfo.map((function(t){return t.headImgUrl}))||[]})})),e},seenAvatarHalfScreenData:function(){var t=this,e=[];return this.seenButton.voteIdList.forEach((function(n){var i=t.findVoteInfoByVoteId(n);if(i){var a=i.userInfo&&i.userInfo.map((function(e){return{avatar:e.headImgUrl,name:e.nickname,openId:e.openId,type:t.seenText}}))||[];e.push({users:a,rate:Number.parseInt(i.voteName),desc:"".concat(a.length,"票")})}})),e},seenTotal:function(){return this.seenUserList.reduce((function(t,e){return t+e.list.length}),0)},displayCommentList:function(){return this.commentInfo.commentList&&this.commentInfo.commentList.map((function(t){return{title:t.username,desc:t.text}}))||[]}},watch:{item:function(){this.voteObject=JSON.parse(JSON.stringify(this.item.vote||{})),this.commentInfo=JSON.parse(JSON.stringify(this.item.commentInfo||{})),this.reset()},rateHalfScreenRate:function(){this.rateHalfScreenChangeHandler()},rateHalfScreenTextareaValue:function(){this.rateHalfScreenChangeHandler()}},created:function(){window.reportVueCreated("src/views/result/block/official-zone/components/zone-block/vote-with-rate.vue"),this.reset()},mounted:function(){},methods:{reset:function(){var t=this;this.likeText=this.likeButton.wording,this.likeButtonLoading=!1,this.seenText=this.seenButton.wording,this.seenButtonLoading=!1,this.voteInfoList.forEach((function(e){e.selectBySelf&&(e.userInfo?e.userInfo.push(t.myUserInfo):e.userInfo=[t.myUserInfo])}))},findVoteInfoByVoteId:function(t){return this.voteInfoList.find((function(e){return e.voteId===t}))},resetMyVote:function(){var t=this;this.voteInfoList.forEach((function(e,n){e.selectBySelf&&(e.selectBySelf=0,e.userInfo&&e.userInfo.splice(e.userInfo.findIndex((function(e){return e.nickname==t.myUserInfo.nickname})),1),t.$set(t.voteInfoList,n,e))}))},setMyVote:function(t){var e=this.findVoteInfoByVoteId(t);this.resetMyVote(),e.userInfo||(e.userInfo=[]),e.userInfo.push(this.myUserInfo),e.selectBySelf=1,this.$set(this.voteInfoList,this.voteInfoList.indexOf(e),e)},sendMyVote:function(t){var e=this,n=this;return new Promise((function(i,a){u.i.getCommonCgiData({cgiName:"S1SVoteTopicInfo",data:{docid:n.voteObject.voteDocId,voteinfo:n.voteInfoList.map((function(e){return"".concat(e.voteId,"_").concat(e.voteId===t?1:0)})).join("_")}}).then((function(t){0!==t.ret?a("系统繁忙，请稍后再试"):(void 0!==t.averageScore&&(e.voteObject.scoreVoteInfo.averageScore=t.averageScore),i())})).catch((function(t){a("请求超时，请稍后再试")}))}))},sendMyComment:function(t,e){var n=this,i=this;return new Promise((function(t,a){u.i.getCommonCgiData({cgiName:"postComment",data:{docid:i.voteObject.voteDocId,content:e}}).then((function(e){if(0!==e.ret)a("系统繁忙，请稍后再试");else{var i=Array.isArray(n.commentInfo.commentList)?n.commentInfo.commentList:[];i.unshift({text:n.rateHalfScreenTextareaValue,username:n.myUserInfo.nickname}),n.$set(n.commentInfo,"commentList",i),t()}})).catch((function(t){a("请求超时，请稍后再试")}))}))},onTap:function(){this.$refs.header.tap(),this.$emit("tap")},onTapLikeBtn:function(){var t=this;if(!this.seenButtonLoading&&!this.likeButtonLoading){if(this.likeButton.voteIdList.indexOf(this.myVoteId)>-1)return this.likeButtonLoading=!0,this.sendMyVote("").then((function(){t.likeButtonLoading=!1,t.resetMyVote()})).catch((function(e){t.likeButtonLoading=!1,d.a.alert(e,{isAndroid:!1})})),void this.M_clickReport({clickZone:2,clickContent:"取消".concat(this.likeText)});var e=this.likeButton.voteIdList[0];this.likeButtonLoading=!0,this.sendMyVote(e).then((function(){t.likeButtonLoading=!1,t.setMyVote(e)})).catch((function(e){t.likeButtonLoading=!1,d.a.alert(e,{isAndroid:!1})})),this.M_clickReport({clickZone:2,clickContent:"选中".concat(this.likeText)}),this.$emit("tap")}},onTapSeenBtn:function(){var t=this;if(!this.seenButtonLoading&&!this.likeButtonLoading){if(this.seenButton.voteIdList.indexOf(this.myVoteId)>-1)return this.seenButtonLoading=!0,this.sendMyVote("").then((function(){t.seenButtonLoading=!1,t.resetMyVote()})).catch((function(e){t.seenButtonLoading=!1,d.a.alert(e,{isAndroid:!1})})),void this.M_clickReport({clickZone:2,clickContent:"取消".concat(this.seenText)});this.$refs.rateHalfScreen.show(),this.rateHalfScreenTextareaValue&&setTimeout((function(){t.$refs.rateHalfScreen.showSlot()}),10),z=document.body.scrollTop||document.documentElement.scrollTop,this.M_clickReport({clickZone:2,clickContent:"选中".concat(this.seenText)}),this.$emit("tap")}},onTapLikeList:function(){this.$refs.likeAvatarHalfScreen.show(),this.M_clickReport({clickZone:8,clickContent:this.likeUserList.length}),this.$emit("tap")},onTapSeenList:function(){this.$refs.seenAvatarHalfScreen.show(),this.M_clickReport({clickZone:9,clickContent:this.seenTotal}),this.$emit("tap")},onTapComment:function(){this.M_go(this.commentInfo.jumpInfo),this.M_clickReport({clickZone:10,clickContent:this.commentInfo.count}),this.$emit("tap")},onTapUser:function(t){this.M_clickReport({clickZone:3,clickContent:t.name+t.type}),this.$emit("tap")},onTapHalfScreenBottom:function(t){this.$refs[t].hide(),this.$refs.vote.markButtons(),this.$emit("tap")},onTapSyncToLookALookTipsInfo:function(){this.M_clickReport({clickZone:5,clickContent:"tip"}),this.$emit("tap")},rateHalfScreenChangeHandler:function(){this.rateHalfScreenDesc=D[this.rateHalfScreenRate],this.rateHalfScreenCanSubmit=!1,this.rateHalfScreenRate?(this.$refs.rateHalfScreen.showSlot(),(!this.rateHalfScreenTextareaValue||this.rateHalfScreenTextareaValue.length<=this.COMMENT_MAX_LENGTH)&&(this.rateHalfScreenCanSubmit=!0)):this.$refs.rateHalfScreen.hideSlot()},onRateHalfScreenClose:function(){document.body.scrollTop=z,document.documentElement.scrollTop=z,this.rateHalfScreenTextareaValue||(this.rateHalfScreenRate=0)},onRateHalfScreenSubmit:function(){var t=this;this.seenButtonLoading=!0;var e=this.rateHalfScreenRate,n="1000".concat(e),i=[this.sendMyVote(n)];this.rateHalfScreenTextareaValue&&i.push(this.sendMyComment(n,this.rateHalfScreenTextareaValue)),Promise.all(i).then((function(){t.M_clickReport({clickZone:6,clickContent:e}),t.rateHalfScreenTextareaValue&&t.M_clickReport({clickZone:7,clickContent:t.rateHalfScreenTextareaValue}),t.seenButtonLoading=!1,t.rateHalfScreenRate=0,t.rateHalfScreenTextareaValue="",t.setMyVote(n)})).catch((function(e){t.seenButtonLoading=!1,d.a.alert(e,{isAndroid:!1})})),this.$refs.rateHalfScreen.hide()}}},q=(n(3069),Object(r.a)(Z,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"oz__vote-with-rate oz__item",attrs:{"data-id":t.M_exposeId()},on:{click:t.onTap}},[n("hd",t._b({ref:"header"},"hd",t.$props,!1)),n("div",{staticClass:"oz__body"},[n("ui-vote-movie",{ref:"vote",attrs:{"like-button":{text:t.likeButton.wording,selected:t.likeButton.voteIdList.indexOf(t.myVoteId)>-1,loading:t.likeButtonLoading},"seen-button":{text:t.seenButton.wording,selected:t.seenButton.voteIdList.indexOf(t.myVoteId)>-1,loading:t.seenButtonLoading},like:t.likeUserList.length?{text:t.likeButton.wording,desc:t.likeUserList.length+"个朋友",list:t.likeUserList}:null,seen:t.seenTotal?{text:t.seenButton.wording,desc:t.seenTotal+"个朋友",list:1==t.seenTotal?t.seenUserListSingle:t.seenUserList}:null,comment:t.displayCommentList.length?{text:t.commentInfo.title,desc:t.commentInfo.count>3?t.commentInfo.count+"个":"",list:t.displayCommentList.slice(0,3)}:null,vote:+t.averageRate.toFixed(1)},on:{"tap:like-btn":t.onTapLikeBtn,"tap:seen-btn":t.onTapSeenBtn,"tap:like":t.onTapLikeList,"tap:seen":t.onTapSeenList,"tap:comment":t.onTapComment}}),t.voteObject.info?n("sync-to-look-a-look-tips",{attrs:{info:t.voteObject.info,tip:t.voteObject.tip},on:{"tap:info":t.onTapSyncToLookALookTipsInfo}}):t._e(),n("ui-avatar-half-screen",{ref:"likeAvatarHalfScreen",attrs:{title:t.likeUserList.length+"个朋友"+t.likeText,data:t.likeAvatarHalfScreenData},on:{"tap:user":t.onTapUser,"tap:bottom":function(e){return t.onTapHalfScreenBottom("likeAvatarHalfScreen")}}}),n("ui-avatar-half-screen",{ref:"seenAvatarHalfScreen",attrs:{title:t.seenTotal+"个朋友"+t.seenText,data:t.seenAvatarHalfScreenData},on:{"tap:user":t.onTapUser,"tap:bottom":function(e){return t.onTapHalfScreenBottom("seenAvatarHalfScreen")}}}),n("ui-rate-half-screen",{ref:"rateHalfScreen",attrs:{title:t.seenButton.wording,desc:t.rateHalfScreenDesc,"can-submit":t.rateHalfScreenCanSubmit},on:{close:t.onRateHalfScreenClose,submit:t.onRateHalfScreenSubmit},model:{value:t.rateHalfScreenRate,callback:function(e){t.rateHalfScreenRate=e},expression:"rateHalfScreenRate"}},[n("div",{staticClass:"ui-rate-dialog-textarea-box"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.rateHalfScreenTextareaValue,expression:"rateHalfScreenTextareaValue"}],staticClass:"weui-textarea",attrs:{placeholder:"写下你的想法...","inner-scroll-ignore":"",rows:"3"},domProps:{value:t.rateHalfScreenTextareaValue},on:{input:function(e){e.target.composing||(t.rateHalfScreenTextareaValue=e.target.value)}}}),t.rateHalfScreenTextareaValue.length>t.COMMENT_MAX_LENGTH?n("p",{staticClass:"ui-rate-dialog-textarea-tips"},[t._v("\n          "+t._s(t.rateHalfScreenTextareaValue.length)+" / "+t._s(t.COMMENT_MAX_LENGTH)+"\n        ")]):t._e()])])],1)],1)}),[],!1,null,"3fc01eb0",null));e.default=q.exports},251:function(t,e,n){},255:function(t,e,n){},263:function(t,e,n){(function(e){var n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,r="object"==typeof e&&e&&e.Object===Object&&e,c="object"==typeof self&&self&&self.Object===Object&&self,l=r||c||Function("return this")(),u=Object.prototype.toString,f=Math.max,d=Math.min,h=function(){return l.Date.now()};function p(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function m(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==u.call(t)}(t))return NaN;if(p(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=p(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(n,"");var r=a.test(t);return r||o.test(t)?s(t.slice(2),r?2:8):i.test(t)?NaN:+t}t.exports=function(t,e,n){var i,a,o,s,r,c,l=0,u=!1,v=!1,_=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function k(e){var n=i,o=a;return i=a=void 0,l=e,s=t.apply(o,n)}function g(t){return l=t,r=setTimeout(y,e),u?k(t):s}function b(t){var n=t-c;return void 0===c||n>=e||n<0||v&&t-l>=o}function y(){var t=h();if(b(t))return S(t);r=setTimeout(y,function(t){var n=e-(t-c);return v?d(n,o-(t-l)):n}(t))}function S(t){return r=void 0,_&&i?k(t):(i=a=void 0,s)}function T(){var t=h(),n=b(t);if(i=arguments,a=this,c=t,n){if(void 0===r)return g(c);if(v)return r=setTimeout(y,e),k(c)}return void 0===r&&(r=setTimeout(y,e)),s}return e=m(e)||0,p(n)&&(u=!!n.leading,o=(v="maxWait"in n)?f(m(n.maxWait)||0,e):o,_="trailing"in n?!!n.trailing:_),T.cancel=function(){void 0!==r&&clearTimeout(r),l=0,i=c=a=r=void 0},T.flush=function(){return void 0===r?s:S(h())},T}}).call(this,n(53))},3069:function(t,e,n){"use strict";n(1328)},3403:function(t,e,n){"use strict";n(1324)},459:function(t,e,n){"use strict";var i={methods:{ozJump:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this;e.M_confirm_go(t.dialog,t)}},computed:{M_canHeaderJump:function(){return!!this.item.header&&!!(this.item.header.jumpUrl||this.item.header.weappUrl||this.item.header.jumpInfo)}}};e.a=i},486:function(t,e,n){"use strict";n(251)},487:function(t,e,n){"use strict";n(255)},489:function(t,e,n){"use strict";var i=n(39),a=n(459),o={props:{title:{type:String,default:""},tags:{type:Array,default:function(){return[]}},jump:{type:Boolean,default:!0},moreText:{type:String,default:""}}},s=(n(486),n(4)),r=Object(s.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"oz__header line",class:{active__item:t.jump},attrs:{role:t.jump?"button":"option"}},[n("div",{staticClass:"line__item oz__header-word",class:{flex1:t.jump&&t.moreText}},[n("p",[t._v(t._s(t.title))]),t.tags.length?n("ui-tags",{attrs:{flex:"",tags:t.tags}}):t._e()],1),t.jump&&!t.moreText?n("ui-arrow",{attrs:{gap:0,align:"flex"}}):t.jump&&t.moreText?n("div",{directives:[{name:"active",rawName:"v-active.stop",modifiers:{stop:!0}}],staticClass:"oz__header-more active__mask",on:{click:function(e){return e.stopPropagation(),t.$emit("tap:more",{zone:3,content:"更多"})}}},[t._v("\n    "+t._s(t.moreText)+"\n    "),n("ui-arrow")],1):t._e()],1)}),[],!1,null,null,null).exports,c=n(0),l=n(2),u={components:{accessHeader:r},mixins:[c.l,i.a,a.a],props:{data:{type:Object,default:function(){return{}}},item:{type:Object,default:function(){return{}}},pos:{type:Number,default:0},typePos:{type:Number,default:0}},computed:{header:function(){return this.item.header||{}},jump:function(){return!!(this.header.jumpUrl||this.header.weappUrl||this.header.jumpInfo)},moreText:function(){return this.header.moreText||c.g.L("更多")}},methods:{tap:function(t){var e=this;c.g.isObjectEmpty(t)&&(t={zone:1});var n=t.zone;c.g.fastClickCheck((function(){var i=e,a=JSON.parse(JSON.stringify(i.header)),o=a.jumpInfo,s={parentSearchID:e.M_composeParentSid({t:e.item.parentType||0,s:c.b.searchId,did:e.item.docID,rid:e.$store.state.result.previousRid}),crossExtReqParams:[{key:"cookies",textValue:e.$store.state.result.state.cookies}],subType:o&&o.subType||e.data.subType||""};o?o.jumpType===l.l.VERTICAL?o=Object.assign({extParams:s},o):o.jumpType===l.l.H5&&(o.jumpUrl=c.g.addParamsToURLSearch(c.g.object2params({tmplByPassJson:JSON.stringify(s)}),o.jumpUrl)):a.jumpUrl&&(a.jumpUrl=c.g.addParamsToURLSearch(c.g.object2params({tmplByPassJson:JSON.stringify(s)}),a.jumpUrl)),i.ozJump(o||i.header),i.M_clickReport({clickZone:n||1,clickContent:t.content||i.header.title})}),2e3),this.$emit("tap")}}},f=(n(487),Object(s.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item.header?n("accessHeader",{attrs:{title:t.item.header.title,jump:t.jump,tags:t.item.header.tag,"more-text":t.moreText},on:{"tap:more":t.tap},nativeOn:{click:function(e){return e.stopPropagation(),t.tap.apply(null,arguments)}}}):t._e()}),[],!1,null,null,null));e.a=f.exports},804:function(t,e,n){"use strict";n(1320)},806:function(t,e,n){"use strict";n(1321)}}]);